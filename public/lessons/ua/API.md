# ![ico-30 study] API

[** ♫**](sounds/ua/api.mp3)

**_Application Programming Interface_** (**API**) дає змогу двом системам взаємодіяти одна з одною.

Припустімо, існує якийсь зовнішній щодо вашого додатка набір сервісів, які значно розширюють функціональність вашого додатка.
Якщо існує якийсь програмний інтерфейс, що забезпечує вам доступ до цих сервісів, то це і є **API**.
Тобто вам не потрібно включати ці сервіси у свій застосунок, вам не важливо, якою мовою вони написані, вам важливо тільки знати, яким способом їх активувати.

![ico-20 pin] Працюючи на клієнті, ваш код постійно використовує браузерні API<br>(наприклад, ~DOM API~, ~Audio API~, ~Fetch API~, ~File API~, ~Notification API~, ~IndexedDB API~).
![ico-20 pin] До багатьох веб-API ви можете підключитися віддалено<br>(наприклад, [![ico-70 firebase]](https://firebase.google.com/) або [![ico-35 google-maps]](https://developers.google.com/maps/documentation/javascript/)).

## ![ico-25 icon] CRUD

[** ♫**](sounds/ua/api-crud.mp3)

Як правило, будь-який додаток взаємодіє зі своїм бекенд-апі, розташованим на сервері.
Бекенд-апі забезпечує додатку доступ до даних, які зберігаються на сервері, за допомогою методів **CRUD**.
При цьому вас абсолютно не стосується, як саме дані зберігаються на сервері: у вигляді окремих файлів, або у вигляді записів у базі даних.

^^^[CRUD]

**CRUD** (_create_, _read_, _update_, _delete_) — це чотири основних типи запитів до сервера.

Для ідентифікації типу запиту використовується **метод доступу**, або **дієслово**, яке ідентифікує операцію з ресурсом.

| **GET** | **POST** | **PUT** | **PATCH** | **DELETE** | **HEAD** |

| ~read~   | **GET**    | отримати дані                                |
| ~create~ | **POST**   | створення нового ресурсу (нового запису)     |
| ~update~ | **PUT**    | повне оновлення наявного ресурсу (запису)    |
| ~update~ | **PATCH**  | часткове оновлення наявного ресурсу (запису) |
| ~delete~ | **DELETE** | видалення ресурсу                            |
| ~read~   | **HEAD**   | отримання інформації про ресурс              |

^^^

### ![ico-25 icon] Resource

[** ♫**](sounds/ua/api-resource.mp3)

^^^[ресурс]

Головне під час взаємодії з серверним API - визначити зміст поняття "ресурс" і присвоїти кожному ресурсу унікальний ідентифікатор.
^^Наприклад, як ресурс може виступати інформація про користувача. Знаючи унікальний ідентифікатор юзера, ви можете надіслати запит серверному API на отримання даних юзера (**GET**), на зміну даних юзера (**PUT** або **PATCH**), на створення нового юзера (**POST**).^^

Таким чином, під час взаємодії з віддаленим API під терміном "ресурс" ми маємо на увазі якийсь **фрагмент інформації, що має унікальний ідентифікатор.**

Різниця між **~URL~** (~Uniform Resource Locator~) і **~URI~** (~Uniform Resource Identifier~) полягає якраз у тому, що **~URL~** вказує точне місце розташування ресурсу на сервері, а **~URI~** вказує тільки ідентифікатор ресурсу, що забезпечує більшу гнучкість серверного API в плані розміщення даних і форми їх зберігання.

Наприклад, на сервері може зберігатися файл зображення, але те саме зображення може зберігатися в базі даних у вигляді текстового рядка у форматі [**Base64**](https://www.base64encode.org/).

^^^

________

## ![ico-25 icon] Request & Response

[** ♫**](sounds/ua/api-request-response.mp3)

Будь-який API працює за принципом "запит" - "відповідь".
Ваш застосунок надсилає запит, і якщо запит валідний, то API надсилає застосунку відповідь.

Форма запиту залежить від API.
Це може бути метод, наприклад, **~setTimeout~** або **~fetch~**.
Це може бути об'єкт, властивості та методи якого забезпечують вам доступ до можливостей браузерного API. Усі об'єкти **BOM** і **DOM** є елементами браузерного API.
Це може бути конструктор, за допомогою якого ви створюєте об'єкти, що забезпечують вам доступ до можливостей браузерного API. Наприклад, конструктор **~XMLHttpRequest~** або конструктор **~FileReader~**.

У разі віддаленого API запит здійснюється через інтернет і набуває форми якоїсь веб-адреси, яка називається **~endpoint~** (точка доступу до віддаленого API).

_____________________________________

## ![ico-25 icon] API endpoints

[** ♫**](sounds/ua/api-endpoints.mp3)

Кожен API має документацію та специфікації, які визначають спосіб передавання інформації.

^^^[![](icons/swagger.png)]
![](illustrations/api-endpoints-01.png)
^^^

API-інтерфейси можуть використовувати HTTP-запити для отримання інформації від веб-додатка або веб-сервера.

У разі REST API запит здійснюється через інтернет і набуває форми якоїсь веб-адреси, яка називається **~endpoint~** (точка доступу до віддаленого API).

^^^[additional]
Понятие "endpoint" используется не только в контексте REST API, но и в более широком смысле в сфере информационных технологий и сетевых взаимодействий.

• В сетевых протоколах endpoint может обозначать любую конечную точку связи в сети, будь то IP-адрес и порт в TCP/IP, или конечная точка в маршрутизации сообщений.
• В SOAP (Simple Object Access Protocol) API endpoint также обозначает URL-адрес, к которому отправляются SOAP-сообщения. Это похоже на REST API, но используется в других протоколах и форматах данных.
• В GraphQL API endpoint представляет собой одну конечную точку, через которую клиент может запрашивать конкретные данные, используя сложные запросы.
• В микросервисах endpoint может обозначать любую точку входа для взаимодействия с отдельным микросервисом. Каждый микросервис может иметь свои собственные endpoints для различных функциональностей.
• В более широком смысле, endpoint может обозначать любую точку, через которую осуществляется доступ к ресурсу или службе, будь то внутри системы или между различными системами.
^^^

**~endpoint~** - це URI-подібний рядок, який вам надає API для віддаленого доступу до ресурсів.

Давайте розберемося, що ж включає цей рядок.

Почнемо з того, що сам **API** має **URL**, наприклад: https://api.example.com.
І цей **URL** буде обов'язково присутній у кожному **~endpoint~**.
Однак для доступу до ресурсів потрібно вказати, який саме ресурс вас цікавить, і що ви хочете зробити з цим ресурсом (отримати ресурс, створити новий, видалити або оновити наявний).
**~endpoint~** містить всю цю інформацію.

Як ми вже говорили раніше, кожен ресурс має унікальний ідентифікатор і з кожним ресурсом може бути виконано низку різних операцій (читання, створення, видалення, оновлення/зміна).

Таким чином, **~endpoint~** не є ні URL (оскільки не містить інформації про розміщення ресурсу), ні URI (оскільки містить у собі не тільки ідентифікатор ресурсу, а й інформацію про операцію з ресурсом).

!хїЯкщо якась операція з ресурсом допустима, то для неї є **~endpoint~**.
Якщо такого **~endpoint~** немає, то ця операція з ресурсом неможлива.

^^^[![](icons/swagger.png)]
![](illustrations/api-endpoints-02.png)
^^^

^^^[![](icons/swagger.png)]
![](illustrations/api-endpoints-04.png)
^^^

^^^[![ico-30 cap]]
^^Розглянемо приклад API https://api.example.com.^^
^^Припустимо, на сервері зберігається база даних користувачів.^^
^^API дає змогу отримати список усіх юзерів і надає вам для цього **~endpoint~**:^^

••https://api.example.com/users/all••

^^Для отримання інформації конкретного юзера з унікальним ідентифікатором **iserId** ендпойнт буде вже іншим:^^

••https://api.example.com/users/${iserId}••


^^Для створення нового юзера (**POST**):^^

••https://api.example.com/user/create••

^^Для повної заміни всіх даних користувача (**PUT**):^^

••https://api.example.com/user/change/${iserId}••

^^Для часткової модифікації даних користувача (**PATCH**):^^
••https://api.example.com/user/update/${iserId}••

^^І для видалення юзера (**DELETE**):^^

••https://api.example.com/user/remove/${iserId}••

^^Серверний API парсить адресу запиту, і якщо цей рядок відповідає одному з допустимих варіантів, і якщо у вас є права на виконання таких операцій, то ваш запит виконується.^^

^^^

Endpoint у REST API - це точка, до якої звертається клієнт, щоб взаємодіяти із сервером.
Він являє собою не просто URL-адресу, а сукупність адреси API і маршруту, який включає ідентифікатор ресурсу та інформацію про те, яку дію треба виконати. Це як веб-адреса, але з додатковими частинами, які вказують, що саме потрібно зробити з даними.

______________________________________________

## ![ico-25 icon] web service

**Деякі терміни:**

| ^^![ico-20 pin] **SOA** — **_Service Oriented Architecture_** — сервіс-орієнтована архітектура веб-додатків (набір архітектурних принципів).^^ |
| ^^![ico-20 pin] **RPC** — **_Remote Procedure Call_** — віддалений виклик процедури.^^ |
| ^^![ico-20 pin] **Сервіс** (service) — набір операцій, що приймають запит (~Request~) і видають відповідь (~Response~).^^ |
| ^^![ico-20 pin] **Веб-сервіс** — програмна система зі стандартизованими інтерфейсами, яку ідентифікує веб-адреса, зі стандартизованими інтерфейсами.^^ |

Веб-сервіси можуть взаємодіяти один з одним і зі сторонніми додатками за допомогою повідомлень, заснованих на певних протоколах.

Найбільшого поширення набули такі протоколи реалізації **_веб-сервісів_**:

![ico-20 green-ok] **SOAP**    (_Simple Object Access Protocol_)
![ico-20 green-ok] **REST**    (_Representational State Transfer_)
![ico-20 green-ok] **XML-RPC** (_XML Remote Procedure Call_)

_________________________________________

### ![ico-20 icon] REST API

Основний принцип **REST** полягає в обмеженні набору операцій - використовуються тільки операції **CRUD** (~Create~ ~Read~ ~Update~ ~Delete~).

Архітектурний стиль **REST** у більшості випадків передбачає використання протоколу HTTP.

Тому команди CRUD перетворено в HTTP-методи **POST** - **GET** - **PUT** - **DELETE**.

^^^[![](icons/postman.png)]
![](illustrations/api-rest-postman.png)
^^^

___________________________________________

### ![ico-20 icon] SOAP vs REST

**_API_** зазвичай класифікуються як **SOAP** або **REST**, і обидва використовуються для доступу до веб-сервісів.

![ico-20 green-ok] **SOAP**: для обміну повідомленнями використовується формат XML.
![ico-20 green-ok] **REST**: для отримання або надсилання інформації використовуються URL-адреси.

**REST** використовує чотири різних HTTP 1.1 дієслова (~GET~, ~POST~, ~PUT~ и ~DELETE~).

На відміну від ~SOAP~, ~REST~ не обов'язково повинен використовувати ~XML~ для надання відповіді.

Існують веб-сервіси на основі REST, які виводять дані у форматі:

| ^^• Command Separated Value (CSV)^^ |
| ^^• JavaScript Object Notation (JSON)^^ |
| ^^• Really Simple Syndication (RSS)^^ |

^^Можна отримати результат у форматі, який легше парсити мовою вашого додатка.^^

_____________________________________
