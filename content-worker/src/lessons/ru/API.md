# ![ico-30 study] API

[** ♫**](sounds/ua/api.mp3)

**_Application Programming Interface_** (**API**) позволяет двум системам взаимодействовать друг с другом.

@@@@
![](illustrations/api-02.png)
Предположим, существует некий внешний по отношению к вашему приложению набор сервисов, которые значительно расширяют функциональность вашего приложения.
Если существует некий программный интерфейс, обеспечивающий вам доступ к этим сервисам, то это и есть **API**.<br>Т.е. вам не нужно включать эти сервисы в свое приложение, вам не важно, на каком языке они написаны, вам важно только знать, каким способом их активировать.
![](illustrations/api-01.png)
@@@@

_________________________

Работая на клиенте, ваш код постоянно использует **браузерные API**<br>(например, **~DOM API~**, **~Audio API~**, **~Fetch API~**, **~File API~**, **~Notification API~**, **~IndexedDB API~**).

Ко многим веб-API вы можете подключиться удаленно
(например, [![ico-70 firebase]](https://firebase.google.com/) or [![ico-35 google-maps]](https://developers.google.com/maps/documentation/javascript/)).
_________________________

## ![ico-25 icon] CRUD

[** ♫**](sounds/ua/api-crud.mp3)

Как правило, любое приложение взаимодействует со своим бекенд-API на сервере.
Бекенд-апи обеспечивает приложению доступ к данным, которые хранятся на сервере, с помощью методов **CRUD**.

^^^[CRUD]

**CRUD** (_create_, _read_, _update_, _delete_) — четыре основных типа запросов к серверу.

Для идентификации типа запроса используется **метод доступа**, или **глагол**, который идентифицирует операцию с ресурсом.

| **GET** | **POST** | **PUT** | **PATCH** | **DELETE** | **HEAD** |

| ~read~   | **GET**    | получить данные                                     |
| ~create~ | **POST**   | создание нового ресурса (новой записи)              |
| ~update~ | **PUT**    | обновление существующего ресурса (записи)           |
| ~update~ | **PATCH**  | частичное обновление существующего ресурса (записи) |
| ~delete~ | **DELETE** | удаление ресурса                                    |
| ~read~   | **HEAD**   | получение информации о ресурсе                      |

^^При этом вас абсолютно не касается, как именно данные хранятся на сервере: в виде отдельных файлов, или в виде записей в базе данных.^^

^^^
____________________

## ![ico-25 icon] Request & Response

[** ♫**](sounds/ua/api-request-response.mp3)

Любой API работают по принципу «запрос» — «ответ».
Ваше приложение посылает запрос, и если запрос валидный, то API присылает приложению ответ.

Форма запроса зависит от API.
Это может быть метод, например, **~setTimeout~** или **~fetch~**.
Это может быть объект, свойства и методы которого обеспечивают вам доступ к возможностям браузерного API. Все объекты **~BOM~** и **~DOM~** являются элементами браузерного API.
Это может быть конструктор, с помощью которого вы создаете объекты, обеспечивающие вам доступ к возможностям браузерного API. Например, конструктор **~XMLHttpRequest~** или конструктор **~FileReader~**.

__________________________________

### ![ico-25 icon] Resource

[** ♫**](sounds/ua/api-resource.mp3)

Главное при взаимодействии с серверным API - определить содержание понятия "ресурс" и присвоить каждому ресурсу уникальный идентификатор.

^^Например, в качестве ресурса может выступать информация о юзере. Тогда, зная уникальный идентификатор ресурса, вы можете послать запрос серверному АПИ на получение данных юзера по его идентификатору (**GET**), можете послать запрос на изменение данных юзера (**PUT** или **PATCH**) или же отправить запрос на создание нового юзера (**POST**).^^

Таким образом, при взаимодействии с удаленным API под термином "ресурс" мы подразумеваем **некий фрагмент информации, имеющий уникальный идентификатор.**

^^Различие между **URL** (Uniform Resource Locator) и **URI** (Uniform Resource Identifier) заключается как раз в том, что URL указывает точное место расположения ресурса на сервере, а URI указывает только идентификатор ресурса, что обечпечивает большую гибкость серверного API в плане размещения данных и формы их хранения.^^

Ресурсом может быть файл, хранящийся на сервере, или отдельная запись в базу данных.

Например, на сервере может храниться файл изображения, но то же самое изображение может храниться в базе данных в виде текстовой строки в формате [**Base64**](https://www.base64encode.org/).

_____________________________________

## ![ico-25 icon] API endpoints

[** ♫**](sounds/ua/api-endpoints.mp3)

Каждый API имеет документацию и спецификации, которые определяют способ передачи информации.

^^^[![](icons/swagger.png)]
![](illustrations/api-endpoints-01.png)
^^^

API-интерфейсы могут использовать HTTP-запросы для получения информации от веб-приложения или веб-сервера.

В случае REST API запрос осуществляется через интернет, и, принимает форму некоего веб-адреса, который называется **~endpoint~** (точка доступа к удаленному API).

^^^[![](icons/endpoint-icon.png)]
^^Понятие "endpoint" используется не только в контексте REST API, но и в более широком смысле в сфере информационных технологий и сетевых взаимодействий.^^

^^• В сетевых протоколах endpoint может обозначать любую конечную точку связи в сети, будь то IP-адрес и порт в TCP/IP, или конечная точка в маршрутизации сообщений.^^
^^• В SOAP (Simple Object Access Protocol) API endpoint также обозначает URL-адрес, к которому отправляются SOAP-сообщения. Это похоже на REST API, но используется в других протоколах и форматах данных.^^
^^• В GraphQL API endpoint представляет собой одну конечную точку, через которую клиент может запрашивать конкретные данные, используя сложные запросы.^^
^^• В микросервисах endpoint может обозначать любую точку входа для взаимодействия с отдельным микросервисом. Каждый микросервис может иметь свои собственные endpoints для различных функциональностей.^^
^^• В более широком смысле, endpoint может обозначать любую точку, через которую осуществляется доступ к ресурсу или службе, будь то внутри системы или между различными системами.^^
^^^

**~endpoint~** - это URI-подобная строка, которую вам предоставляет API для удаленного доступа к ресурсам.

Давайте разберемся, что же включает эта строка.
Начнем с того, что сам **API** имеет **URL**,  например: https://api.example.com. И этот URL будет обязательно присутствовать в каждом **~endpoint~**.
Однако для доступа к ресурсу нужно указать, какой именно ресурс вас интересует, и что вы хотите сделать с этим ресурсом (получить ресурс, создать новый, удалить или обновить существущий).
**~endpoint~** содержит всю эту информацию.

Как мы уже говорили ранее, каждый ресурс имеет уникальный идентификатор и с каждым ресурсом может быть выполнен ряд различных операций (чтение, создание, удаление, обновление/изменение).

Таким образом, **~endpoint~** не является ни URL (поскольку не содержит информации о размещении ресурса), ни URI (поскольку включает в себя не только идентификатор ресурса, но и информацию об операции с ресурсом).

![ico-25 warn] Если какая-то операция с ресурсом допустима, то для нее есть **~endpoint~**.
![ico-25 warn] Если такого **~endpoint~** нет, то данная операция с ресурсом невозможна.

^^^[![](icons/swagger.png)]
![](illustrations/api-endpoints-02.png)
^^^

^^^[![](icons/swagger.png)]
![](illustrations/api-endpoints-04.png)
^^^

^^^[![](icons/coffee.png)]
^^Рассмотрим пример с API ~https://api.example.com~.^^
^^Предположим, на сервере хранится база данных юзеров.^^
^^API позволяет получить список всех юзеров и предоставляет вам для этого **~endpoint~**:^^

••https://api.example.com/users/all••

^^Для получения информации конкретного юзера с уникальным идентификатором **iserId** эндпойнт будет уже другим:^^

••https://api.example.com/users/${iserId}••


^^Для создания нового юзера (**POST**):^^

••https://api.example.com/user/create••

^^Для полной замены всех данных юзера (**PUT**):^^

••https://api.example.com/user/change/${iserId}••

^^Для частичной модификации данных юзера (**PATCH**):^^
••https://api.example.com/user/update/${iserId}••

^^И для удаления юзера (**DELETE**):^^

••https://api.example.com/user/remove/${iserId}••

^^Серверный API парсит адрес запроса, и если эта строка соответствует одному из допустимых вариантов, и если у вас есть права на выполение таких операций, то ваш запрос выполняется.^^

^^^

Endpoint в REST API - это точка, к которой обращается клиент, чтобы взаимодействовать с сервером.
Он представляет собой не просто URL-адрес, а совокупность адреса API и маршрута, который включает идентификатор ресурса и информацию о том, какое действие надо выполнить. Это как веб-адрес, но с дополнительными частями, которые указывают, что именно нужно сделать с данными.
______________________________________________

## ![ico-25 icon] web service

**Терміни:**

| ^^![ico-20 pin] **SOA** (**_Service Oriented Architecture_**) — сервис-ориентированная архитектура веб-приложений (набор архитектурных принципов).^^ |
| ^^![ico-20 pin] **RPC** (**_Remote Procedure Call_**) — удаленный вызов процедуры.^^ |
| ^^![ico-20 pin] **Сервис** (service) — набор операций, которые принимают запрос (_Request_) и выдают ответ (_Response_).^^ |
| ^^![ico-20 pin] **Веб-сервис** — идентифицируемая веб-адресом программная система со стандартизироваными интерфейсами.^^ |

Веб-сервисы могут взаимодействовать друг с другом и с другими приложениями с помощью уведомлений, основанных на определенных протоколах.

Наибольшее распространение получили следующие протоколы реализации **_веб-сервисов_**:

![ico-20 green-ok] **SOAP**    (_Simple Object Access Protocol_)
![ico-20 green-ok] **REST**    (_Representational State Transfer_)
![ico-20 green-ok] **XML-RPC** (_XML Remote Procedure Call_)

_________________________________________

### ![ico-20 icon] REST API

Основной принцип **REST** заключается в ограничении набора операций — используются только операции **CRUD** (~Create~ ~Read~ ~Update~ ~Delete~).

Архитектурный стиль **REST** в большинстве случаев подразумевает использование протокола HTTP.

Поэтому команды CRUD преобразованы в  HTTP-методы  **POST** — **GET** — **PUT** — **DELETE**.

^^^[![](icons/postman.png)]
![](illustrations/api-rest-postman.png)
^^^

___________________________________________

### ![ico-20 icon] SOAP vs REST

**_API_** обычно классифицируются как **SOAP** или **REST**, и оба используются для доступа к веб-сервисам

![ico-20 green-ok] **SOAP**: для обмена сообщениями используется формат XML
![ico-20 green-ok] **REST**:  для получения или отправки информации используются URL-адреса

**REST** использует четыре разных HTTP 1.1 глагола (~GET~, ~POST~, ~PUT~ и ~DELETE~)

В отличие от ~SOAP~, ~REST~ не обязательно должен использовать ~XML~ для предоставления ответа

Существуют веб-сервисы на основе REST, которые выводят данные в формате:

| ^^• Command Separated Value (CSV)^^ |
| ^^• JavaScript Object Notation (JSON)^^ |
| ^^• Really Simple Syndication (RSS)^^ |

^^Можно получить результат в формате, который легче парсить на языке вашего приложения^^

_____________________________________
